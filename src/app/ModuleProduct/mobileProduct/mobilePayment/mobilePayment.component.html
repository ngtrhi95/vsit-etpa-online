<section class="sub_banner sub_product_mobile_insurance">
    <!-- <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2>Bảo Hiểm Thiết Bị Di Động</h2>
                <p>Bảo Hiểm Thiết Bị Di Động</p>
            </div>
        </div>
    </div> -->
</section>
<div class="container">
    <div class="payment-sumary-frame col-md-3">
        <h3>PHÍ BẢO HIỂM</h3>
        <hr class="custom-line" />
        <label for="input4">Sản phẩm: Bảo hiểm thiết bị di động</label>
        <label for="input4">Ngày mua sản phẩm:</label>
        <span style="margin-left: 16px; font-weight: bold;"> {{ today | date: "dd/MM/yyyy" }}</span>
        <!-- <hr class="custom-line" /> -->
        <div>
            <div class="row" style="margin-bottom: 16px;">
                <div class="col-md-12">
                    <label> <i class="fa fa-percent" aria-hidden="true"></i> Tỉ lệ phí</label>
                    <p style="font-size: 18px; font-weight: bold; text-align: right;">{{ costRate }} <i class="fa fa-percent" aria-hidden="true"></i></p>
                </div>
            </div>
            <!-- <div class="row" style="margin-bottom: 16px;">
                <div class="col-md-12">
                    <label> <i class="fa fa-dollar" aria-hidden="true"></i> Phí bảo hiểm (có VAT)</label>
                    <p style="font-size: 18px; font-weight: bold; text-align: right;">{{ discount | numberConverter }} vnđ</p>
                </div>
            </div> -->
            <hr class="dashed-line" />
            <div>
                <label>Thời hạn bảo hiểm</label>
                <div>
                    <span> {{ effectiveDate | date: "dd/MM/yyyy" }} - {{ expireDate | date: "dd/MM/yyyy" }} </span>
                </div>
            </div>
            <hr class="dashed-line" style="margin-top: 6px;" />
            <div class="row" style="margin-bottom: 16px;">
                <div class="col-md-12">
                    <label> <i class="fa fa-dollar" aria-hidden="true"></i> Phí bảo hiểm</label>
                    <p style="font-size: 18px; font-weight: bold; text-align: right;">{{ mobileContractModel.totalInsuranceCost | numberConverter }} vnđ</p>
                </div>
            </div>
            <hr *ngIf="receiveCertificate" class="dashed-line" style="margin-top: 6px;" />
            <div *ngIf="receiveCertificate">
                <div class="form-group">
                    <input
                        type="checkbox"
                        [checked]="mobileContractModel.takingPaperCertification"
                        (change)="mobileContractModel.takingPaperCertification = !mobileContractModel.takingPaperCertification"
                        name="optionsRadios"
                        id="optionsRadios1xx"
                    />
                    <label for="optionsRadios1xx"> Nhận Giấy chứng nhận bảo hiểm</label>
                    <small
                        ><cite>GCNBH sẽ được chuyển phát nhanh đến quý khách trong vòng <b>02</b> ngày làm việc.</cite></small
                    >
                    <small
                        ><cite><b>Miễn phí vận chuyển</b></cite></small
                    >
                </div>
            </div>
        </div>
    </div>
    <div class="payment-step col-md-9">
        <!-- process nav -->
        <div class="row bs-wizard" style="border-bottom:0;">
            <div class="col-xs-4 bs-wizard-step complete">
                <div class="progress"><div class="progress-bar"></div></div>
                <a href="#" class="bs-wizard-dot"> <i class="fa fa-book process-nav-icon"></i> </a>
                <div class="text-center bs-wizard-stepnum">Thông tin hợp đồng</div>
            </div>
            <div class="col-xs-4 bs-wizard-step" [ngClass]="blNextStep ? 'complete' : 'disabled'">
                <div class="progress"><div class="progress-bar"></div></div>
                <a href="#" class="bs-wizard-dot"> <i class="fa fa-check-square process-nav-icon"></i> </a>
                <div class="text-center bs-wizard-stepnum">Xác nhận thông tin</div>
            </div>
            <div class="col-xs-4 bs-wizard-step disabled">
                <div class="progress"><div class="progress-bar"></div></div>
                <a href="#" class="bs-wizard-dot"> <i class="fa fa-credit-card process-nav-icon"></i> </a>
                <div class="text-center bs-wizard-stepnum">Thanh toán</div>
            </div>
        </div>
        <!-- end process nav -->
        <div [hidden]="blNextStep">
            <div [hidden]="infoNextStep">
                <div class="row" [formGroup]="deviceForm">
                    <h4 style="margin: 12px 0;">Thông Tin Sản Phẩm</h4>
                    <div class="form-group col-md-6 col-xs-12">
                        <label for="input1">Chương trình bảo hiểm <span style="color: red">*</span></label>
                        <select2-ng2
                            [(ngModel)]="mobileContractModel.baseMobileDeviceContract.MobileDeviceContractType"
                            (ngModelChange)="changeContractTypeNonBusiness()"
                            [allowClear]="false"
                            formControlName="contractType"
                        >
                            <select class="form-control" data-placeholder="Chọn chương trình" style="width: 100%">
                                <option value=""></option>
                                <option *ngFor="let p of contractTypes" [value]="p.type">{{ p.value }}</option>
                            </select>
                        </select2-ng2>
                    </div>
                    <div class="form-group col-md-6 col-xs-12">
                        <label for="input1">Loại sản phẩm <span style="color: red">*</span></label>
                        <select2-ng2
                            [(ngModel)]="mobileContractModel.baseMobileDeviceContract.DeviceCategoryType"
                            (ngModelChange)="changeDeviceType()"
                            [allowClear]="false"
                            formControlName="deviceType"
                        >
                            <select class="form-control" data-placeholder="Chọn loại sản phẩm" style="width: 100%">
                                <option value=""></option>
                                <option *ngFor="let p of deviceTypes" [value]="p.type">{{ p.value }}</option>
                            </select>
                        </select2-ng2>
                    </div>
                    <div class="form-group col-md-6 col-xs-12">
                        <label for="input1">Hãng sản xuất <span style="color: red">*</span></label>
                        <select2-ng2 [(ngModel)]="mobileContractModel.insuredMobileDevice.DeviceProducerId" (ngModelChange)="changeProducer()" [allowClear]="false" formControlName="brand">
                            <select class="form-control" data-placeholder="Chọn hãng sản xuất" style="width: 100%">
                                <option value=""></option>
                                <option *ngFor="let p of producers" [value]="p.id">{{ p.name }}</option>
                            </select>
                        </select2-ng2>
                    </div>
                    <div class="form-group col-md-6 col-xs-12" [class.has-error]="deviceForm['controls'].model?.invalid && deviceForm['controls'].model?.dirty">
                        <label for="input1">Model <span style="color: red">*</span> <small>(theo hóa đơn)</small></label>
                        <input
                            type="text"
                            [(ngModel)]="mobileContractModel.insuredMobileDevice.ModelName"
                            formControlName="model"
                            class="form-control"
                            id="input1"
                            placeholder="Nhập model | vd: Iphone 8 Plus_Gold_64Gb"
                        />
                    </div>
                    <div class="form-group col-md-6 col-xs-12" [class.has-error]="deviceForm['controls'].cost?.invalid && deviceForm['controls'].cost?.dirty">
                        <label for="input4">Giá sản phẩm (vnđ) <span style="color: red">*</span> </label>
                        <input
                            type="text"
                            [(ngModel)]="mobileContractModel.insuredMobileDevice.Price"
                            onlyNum
                            currencyFormatter
                            formControlName="cost"
                            class="form-control"
                            id="input4"
                            (focusout)="priceChange()"
                            placeholder="Nhập giá trị sản phẩm"
                        />
                        <small *ngIf="deviceForm['controls'].cost?.invalid && deviceForm['controls'].cost?.dirty" style="color: orangered">
                            <cite>Giá trị tối thiểu là 100.000 vnđ</cite>
                        </small>
                    </div>
                    <div class="form-group col-md-6 col-xs-12" [class.has-error]="deviceForm['controls'].IMEI?.invalid && deviceForm['controls'].IMEI?.dirty">
                        <label for="input1">Số IMEI <span style="color: red">*</span> </label>
                        <input
                            type="text"
                            [(ngModel)]="mobileContractModel.insuredMobileDevice.IMEI"
                            onlyNum
                            formControlName="IMEI"
                            class="form-control"
                            id="input1"
                            placeholder="Nhập số IMEI sản phẩm"
                        />
                    </div>
                    <div class="form-group col-md-6 col-xs-12">
                        <!-- <span [owlDateTimeTrigger]="dtx" style="margin-left: 16px; font-weight: bold;"> {{ effectiveDate | date: "dd/MM/yyyy" }}</span> -->
                        <!-- <button type="button" class="btn btn-sm btn-warning" [owlDateTimeTrigger]="dtx"><i class="fa fa-calendar" aria-hidden="true"></i></button>
                        <input
                            [owlDateTime]="dtx"
                            [(ngModel)]="today"
                            type="text"
                            class="form-control"
                            placeholder="Ngày mua sản phẩm"
                            disabled
                            style="height: 1px !important; opacity: 0;"
                        />
                        <owl-date-time [pickerType]="'calendar'" #dtx [disabled]="true"></owl-date-time> -->
                    </div>
                </div>
                <div>
                    <h5 style="margin: 12px 0">2 hình mặt trước-sau có số IMEI và 1 hình hóa đơn (3 hình) <span style="color: red">*</span></h5>
                    <image-upload-mobile
                        [_files]="collectedFiles"
                        (numberOfFileChange)="countFileSelected($event)"
                        (listFileChange)="collectFiles($event)"
                        [extensions]="['jpg', 'jpeg', 'png']"
                    ></image-upload-mobile>
                </div>
                <hr style="margin: 4px" />
                <button *ngIf="!fromApp" type="button" (click)="goBack()" class="btn btn-main btn-back-default"><i class="fa fa-arrow-left" aria-hidden="true"></i> QUAY LẠI</button>
                <button type="button" (click)="infoNextStep = !infoNextStep" [disabled]="!(deviceForm.valid && numberOfFile > 2 && mobileContractModel.totalInsuranceCost > 0)" class="btn btn-main btn-confirm pull-right">
                    <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> TIẾP TỤC
                </button>
            </div>

            <div [hidden]="!infoNextStep">
                <!-- <div class="row">
                    <h4 style="margin: 12px 0;">Thời Hạn Bảo Hiểm</h4>
                    <span [owlDateTimeTrigger]="dt1" style="margin-left: 16px; font-weight: bold;"> {{ effectiveDate | date: "dd/MM/yyyy" }} - {{ expireDate | date: "dd/MM/yyyy" }} </span>
                    <button type="button" class="btn btn-sm btn-warning" [owlDateTimeTrigger]="dt1"><i class="fa fa-calendar" aria-hidden="true"></i></button>
                    <input
                        [owlDateTime]="dt1"
                        [(ngModel)]="effectiveDate"
                        type="text"
                        class="form-control"
                        placeholder="Ngày hiệu lực"
                        disabled
                        style="height: 1px !important; opacity: 0;"
                    />
                    <owl-date-time [pickerType]="'calendar'" #dt1 [disabled]="true"></owl-date-time>
                </div> -->
                <div class="row">
                    <!-- <app-customerinfo
                        [customerInfo]="customerInfo"
                        (customerInfoChange)="customerInfoChange($event)"
                        (formValid)="customerFormValid($event)"
                        [title]="'Thông Tin Người Mua'"
                    ></app-customerinfo> -->

                    <h4 style="margin: 12px 0;">Thông Tin Người Mua</h4>
                    <form [formGroup]="customerForm">
                        <div class="col-md-6 col-xs-12">
                            <div class="form-group" [class.has-error]="customerForm['controls'].name?.invalid && customerForm['controls'].name?.dirty">
                                <label for="input1"
                                    >Họ và Tên
                                    <span style="color: red">*</span>
                                </label>
                                <input [(ngModel)]="customerInfo.name" formControlName="name" type="text" class="form-control" id="input1" placeholder="Họ và tên" />
                                <span *ngIf="customerForm['controls'].name?.errors?.required && customerForm['controls'].name?.dirty" class="help-block">
                                    <small>
                                        <cite>Không được để trống</cite>
                                    </small>
                                </span>
                                <span *ngIf="customerForm['controls'].name?.errors?.nameInvalid && customerForm['controls'].name?.dirty" class="help-block">
                                    <small> <cite>Tên phải tối thiểu 2 từ</cite> </small>
                                </span>
                            </div>
                            <div class="form-group" [class.has-error]="customerForm['controls'].phoneNumber?.invalid && customerForm['controls'].phoneNumber?.dirty">
                                <label for="input4"
                                    >Số điện thoại liên hệ
                                    <span style="color: red">*</span>
                                </label>
                                <input
                                    [(ngModel)]="customerInfo.phoneNumber"
                                    formControlName="phoneNumber"
                                    [textMask]="{ mask: maskPhone, guide: false }"
                                    type="text"
                                    class="form-control"
                                    id="input4"
                                    placeholder="Số điện thoại"
                                />
                                <span *ngIf="customerForm['controls'].phoneNumber?.errors?.required && customerForm['controls'].phoneNumber?.dirty" class="help-block">
                                    <small>
                                        <cite>Không được để trống</cite>
                                    </small>
                                </span>
                                <span *ngIf="customerForm['controls'].phoneNumber?.errors?.pattern && customerForm['controls'].phoneNumber?.dirty" class="help-block">
                                    <small>
                                        <cite>Số điện thoại không đúng định dạng</cite>
                                    </small>
                                </span>
                            </div>
                            <div class="form-group" [class.has-error]="customerForm['controls'].idNumber?.invalid && customerForm['controls'].idNumber?.dirty">
                                <label for="input3">CMND <span style="color: red">*</span></label>
                                <input [(ngModel)]="customerInfo.idNumber" formControlName="idNumber" type="text" class="form-control" id="input3" placeholder="CMND" />
                                <span *ngIf="customerForm['controls'].idNumber?.errors?.required && customerForm['controls'].idNumber?.dirty" class="help-block">
                                    <small>
                                        <cite>Không được để trống</cite>
                                    </small>
                                </span>
                                <span *ngIf="customerForm['controls'].idNumber?.errors?.pattern && customerForm['controls'].idNumber?.dirty" class="help-block">
                                    <small>
                                        <cite>CMND không đúng định dạng</cite>
                                    </small>
                                </span>
                            </div>
                            <div class="form-group" [class.has-error]="customerForm['controls'].email?.invalid && customerForm['controls'].email?.dirty">
                                <label for="input6">Email</label>
                                <input [(ngModel)]="customerInfo.email" formControlName="email" type="text" class="form-control" id="input6" placeholder="Email" />
                                <span *ngIf="customerForm['controls'].email?.errors?.required && customerForm['controls'].email?.dirty" class="help-block">
                                    <small>
                                        <cite>Không được để trống</cite>
                                    </small>
                                </span>
                                <span *ngIf="customerForm['controls'].email?.errors?.pattern && customerForm['controls'].email?.dirty" class="help-block">
                                    <small>
                                        <cite>Email không đúng định dạng</cite>
                                    </small>
                                </span>
                            </div>
                        </div>
                        <div class="col-md-6 col-xs-12">
                                <div class="form-group" formGroupName="fullAddress" [class.has-error]="customerForm['controls'].fullAddress.invalid && !isFullAddress()">
                                <label for="input5" id="customerAddress">Địa chỉ <span style="color: red">*</span></label>
                                <select2-ng2 [(ngModel)]="customerInfo.provinceOrCityId" formControlName="provinceOrCityId" (ngModelChange)="getDistricts(customerInfo.provinceOrCityId)">
                                    <select class="form-control" data-placeholder="Tỉnh/Thành phố" style="width: 100%">
                                        <option value=""></option>
                                        <option *ngFor="let p of provinces" [value]="p.id">{{ p.name }}</option>
                                    </select>
                                </select2-ng2>
                                <select2-ng2 [(ngModel)]="customerInfo.districtId" formControlName="districtId" (ngModelChange)="getWards(customerInfo.districtId)">
                                    <select class="form-control" data-placeholder="Quận/Huyện" style="width: 100%">
                                        <option value=""></option>
                                        <option *ngFor="let d of districts" [value]="d.id">{{ d.name }}</option>
                                    </select>
                                </select2-ng2>
                                <select2-ng2 [(ngModel)]="customerInfo.wardId" formControlName="wardId">
                                    <select class="form-control" data-placeholder="Xã/Phường/Thị trấn" style="width: 100%">
                                        <option value=""></option>
                                        <option *ngFor="let w of wards" [value]="w.id">{{ w.name }}</option>
                                    </select>
                                </select2-ng2>
                                <input
                                    [(ngModel)]="customerInfo.addressDetails"
                                    (ngModelChange)="changeAddressDetail()"
                                    formControlName="addressDetails"
                                    type="text"
                                    class="form-control"
                                    id="input99"
                                    placeholder="vd: 24c Phan Đăng Lưu"
                                />
                                <span *ngIf="!isFullAddress()" class="help-block">
                                    <small> <cite>Vui lòng nhập đầy đủ thông tin địa chỉ</cite> </small>
                                </span>
                            </div>
                            <small> <span style="color: red">*</span>: Là thông tin bắt buộc. </small>
                            <br />
                            <small>
                                **: Việc cung cấp email sẽ giúp chúng tôi hỗ trợ quý khách tốt hơn trong các trường hợp cần thông báo đầy đủ đến quý khách.
                            </small>
                        </div>
                    </form>
                </div>
                <hr style="margin: 4px" />
                <button type="button" (click)="infoNextStep = !infoNextStep" class="btn btn-main btn-back-default"><i class="fa fa-arrow-left" aria-hidden="true"></i> QUAY LẠI</button>
                <button
                    type="button"
                    (click)="nextToConfirm()"
                    [disabled]="!(customerForm.valid && deviceForm.valid && numberOfFile > 2 && isFullAddress())"
                    class="btn btn-main btn-confirm pull-right"
                >
                    <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> TIẾP TỤC
                </button>
            </div>
        </div>
        <div [hidden]="!blNextStep">
            <div class="row">
                <h4 style="margin: 12px 0;">Thông tin người mua</h4>
                <div class="row col-md-12">
                    <div class="col-md-4">Họ & Tên:</div>
                    <div class="col-md-8">
                        <strong>{{ customerInfo.name }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Số điện thoại:</div>
                    <div class="col-md-8">
                        <strong>{{ customerInfo.phoneNumber }}</strong>
                    </div>
                </div>
                <div *ngIf="mixAddressDetail() != ''" class="row col-md-12">
                    <div class="col-md-4">Địa chỉ:</div>
                    <div class="col-md-8">
                        <strong>{{ mixAddressDetail() }}</strong>
                    </div>
                </div>
                <div *ngIf="customerInfo.idNumber" class="row col-md-12">
                    <div class="col-md-4">CMND:</div>
                    <div class="col-md-8">
                        <strong>{{ customerInfo.idNumber }}</strong>
                    </div>
                </div>
                <div *ngIf="customerInfo.email" class="row col-md-12">
                    <div class="col-md-4">Email:</div>
                    <div class="col-md-8">
                        <strong>{{ customerInfo.email }}</strong>
                    </div>
                </div>
            </div>
            <div class="row">
                <h4 style="margin: 12px 0;">Thông tin thiết bị</h4>
                <div class="row col-md-12">
                    <div class="col-md-4">Chương trình bảo hiểm:</div>
                    <div class="col-md-8">
                        <strong>{{ getContractTypeString() }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Loại sản phẩm:</div>
                    <div class="col-md-8">
                        <strong>{{ getDeviceTypeString() }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Hãng sản xuất:</div>
                    <div class="col-md-8">
                        <strong>{{ getBrandString() }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Model:</div>
                    <div class="col-md-8">
                        <strong>{{ mobileContractModel.insuredMobileDevice.ModelName }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Giá (vnđ):</div>
                    <div class="col-md-8">
                        <strong>{{ mobileContractModel.insuredMobileDevice.Price | numberConverter }}</strong>
                    </div>
                </div>
                <div class="row col-md-12">
                    <div class="col-md-4">Số IMEI:</div>
                    <div class="col-md-8">
                        <strong>{{ mobileContractModel.insuredMobileDevice.IMEI }}</strong>
                    </div>
                </div>
            </div>
            <hr style="margin: 4px" *ngIf="!fromApp" />
            <div class="row" *ngIf="!fromApp">
                <div class="col-md-12">
                    <div class="form-group">
                        <div style="border: 2px dashed rgb(0,0,0,0.5);padding: 12px 12px 0 12px;background-color: #fff4f4; border-bottom: none">
                            <input type="checkbox" [(ngModel)]="checkedPromise" name="optionsRadios" id="confirm" /> <label for="confirm"> Tôi cam kết và đồng ý rằng:</label>
                        </div>
                        <div (click)="changeStatusPromise()" style="border: 2px dashed rgb(0,0,0,0.5);padding: 12px;background-color: #fff4f4; border-top: none">
                            <ul>
                                Điều khoản quy định về mua sản phẩm bảo hiểm Qúy khách vui lòng xem
                                <a routerLink="/article/terms-of-use" target="_blank">tại đây</a>
                                <li>1. Tất cả các thông tin nêu trên là đầy đủ, xác thực và sẽ thông báo cho PTI khi có bất kỳ thông tin nào thay đổi.</li>
                                <li>
                                    2. Tôi đã đọc, hiểu và đồng ý với <a routerLink="/article/policies" target="_blank">"Điều khoản sử dụng website"</a> và quy tắc bảo hiểm đi kèm sản phẩm này của
                                    PTI.
                                </li>
                                <li>
                                    3. Đơn bảo hiểm sẽ là cơ sở của hợp đồng giữa tôi và Bảo Hiểm PTI, tôi sẽ chấp nhận tất cả các điều kiện bảo hiểm quy định tại hợp đồng bảo hiểm và nộp phí bảo hiểm
                                    đúng theo quy định.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <hr style="margin: 4px" />
            <button type="button" (click)="goBackInStep2()" class="btn btn-main btn-back-default"><i class="fa fa-arrow-left" aria-hidden="true"></i> QUAY LẠI</button>
            <button type="button" (click)="nextStep()" [disabled]="!checkAllowToCheckOut()" class="btn btn-main btn-confirm pull-right">
                <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> TIẾP TỤC
            </button>
        </div>
    </div>
</div>
